{% if t_m %}
let t_m: HashMap<i32, &str> =
    {{  zip_columns }}
    .filter_map(|{{ filter_map_closure|replace("'","")}}| {
        {% if year_condition %}
        production_year
            .filter(|&production_year| {{ year_condition }} && {{ join_conditions }})
            .map(|_| (*id, title.as_str()))
        {% endif %}
    })
    .collect();
{% elif min_loop %}
    {% if single_output %}
        let res: Option<&str> =
            {{ zip_columns }}
            .filter_map(|{{ filter_map_closure|replace("'","")}}| {
                production_year
                    .filter(|&production_year| {{ year_condition }} && {{ join_conditions }})
                    .map(|_| (title.as_str()))
            })
            .min();
    {% endif %}
{% endif %}